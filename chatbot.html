<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>FAQボット（オフライン）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="noindex, nofollow">
  <style>
    :root { --size: 64px; }
    body { font-family: system-ui, sans-serif; margin: 0; }
    #chat-fab {
      position: fixed; right: 20px; bottom: 20px;
      width: var(--size); height: var(--size);
      border-radius: 50%; border: none; cursor: pointer;
      box-shadow: 0 6px 24px rgba(0,0,0,.2);
      display: flex; align-items: center; justify-content: center;
      font-size: 20px; background: #2563eb; color: #fff;
      padding: 0 14px; width: auto; height: 52px; border-radius: 30px; gap: 6px;
    }
    #chat-fab span {
      background: #fff; color: #2563eb; font-weight: 600;
      border-radius: 8px; padding: 4px 8px; font-size: 14px;
    }
    #chat-panel {
      position: fixed; right: 20px; bottom: calc(20px + var(--size) + 12px);
      width: min(92vw, 360px); height: 540px; max-height: 75vh;
      background: #fff; border: 1px solid #e5e7eb; border-radius: 16px;
      box-shadow: 0 10px 32px rgba(0,0,0,.18);
      display: none; flex-direction: column; overflow: hidden;
    }
    #chat-header { padding: 10px 12px; background: #f8fafc; border-bottom: 1px solid #e5e7eb; font-weight: 600; }
    #search-area { padding: 8px 12px; border-bottom: 1px solid #eef0f3; }
    .search-row { display: flex; gap: 6px; }
    .search-row input { flex: 1; padding: 8px; border: 1px solid #d1d5db; border-radius: 8px; }
    .btn { background: #fff; border: 1px solid #d1d5db; border-radius: 8px; padding: 8px 10px; cursor: pointer; }
    .btn:hover { background: #f3f4f6; }
    #result-count { color: #6b7280; font-size: 12px; margin-top: 6px; }
    #result-list { padding: 8px 12px; display: flex; flex-direction: column; gap: 6px; overflow-y: auto; max-height: 160px; }
    .result-item { border: 1px solid #e5e7eb; border-radius: 10px; padding: 8px; cursor: pointer; }
    .small { font-size: 12px; color: #6b7280; }
    #chat-log { flex: 1; padding: 12px; overflow-y: auto; line-height: 1.5; }
    .msg { margin: 8px 0; }
    .bot { color: #1f2937; }
    .hint { color: #6b7280; font-size: 12px; }
    #answer-wrap { padding: 8px 12px; border-top: 1px solid #eef0f3; display: none; }
    #answer-title { font-size: 14px; margin: 0 0 6px; }
    #answer-box { white-space: pre-wrap; border: 1px solid #e5e7eb; border-radius: 10px; padding: 8px; background: #fafafa; }
    #answer-tools { margin-top: 6px; display: flex; gap: 6px; }
    mark { background: #fef08a; color: #111827; padding: 0 2px; border-radius: 4px; }
    .qbtn { display: block; width: 100%; text-align: left; padding: 10px 12px; margin: 8px 0; border: 1px solid #d1d5db; border-radius: 10px; background: #fff; cursor: pointer; }
    .qbtn:hover { background: #f3f4f6; }
    .cat { font-weight: 600; margin-top: 10px; }
    #chat-fab { z-index: 10000; }
    #chat-panel  { display: none; flex-direction: column; }
  </style>
</head>
<body>
  <!-- 各入門ページへの固定リンクボタン（iframeでは非表示にする） -->
  <div id="portal-links" style="
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
  ">
    <a href="pages/ai.html"
       style="
         background: #3b82f6;
         color: #fff;
         padding: 10px 16px;
         border-radius: 8px;
         text-decoration: none;
         font-weight: 600;
         box-shadow: 0 4px 12px rgba(0,0,0,0.2);
       ">
      🤖 AI入門ページへ
    </a>

    <a href="pages/powerautomate.html"
       style="
         background: #10b981;
         color: #fff;
         padding: 10px 16px;
         border-radius: 8px;
         text-decoration: none;
         font-weight: 600;
         box-shadow: 0 4px 12px rgba(0,0,0,0.2);
       ">
      ⚙️ Power Automateページへ
    </a>

    <a href="pages/web.html"
       style="
         background: #2563eb;
         color: #fff;
         padding: 10px 16px;
         border-radius: 8px;
         text-decoration: none;
         font-weight: 600;
         box-shadow: 0 4px 12px rgba(0,0,0,0.2);
       ">
      🌐 Web入門ページへ
    </a>

    <a href="pages/data-yuragi.html"
       style="
         background: #22c55e;
         color: #0b2312;
         padding: 10px 16px;
         border-radius: 8px;
         text-decoration: none;
         font-weight: 700;
         box-shadow: 0 4px 12px rgba(0,0,0,0.2);
       ">
      📊 データゆらぎページへ
    </a>
  </div>

<button id="chat-fab" aria-label="チャットを開く">💬 チャット <span>検索OK</span></button>

<div id="chat-panel" role="dialog" aria-modal="true" aria-label="チャットパネル">
  <!-- ヘッダー（×ボタン付き） -->
  <div id="chat-header" style="position: relative;">
    FAQボット（オフライン）
    <button id="chat-close" aria-label="閉じる" style="
      position: absolute;
      top: 4px;
      right: 8px;
      background: none;
      border: none;
      color: #555;
      font-size: 20px;
      cursor: pointer;
    ">×</button>
  </div>

  <!-- 検索UI -->
  <div id="search-area">
    <div class="search-row">
      <input id="kw" type="text" placeholder="知りたいことを入力（例: 住所 ピン）">
      <button id="btnSearch" class="btn">検索</button>
      <button id="btnClear" class="btn">クリア</button>
    </div>
    <div id="result-count"></div>
  </div>

  <div id="result-list"></div>

  <!-- カテゴリ→質問→回答 -->
  <div id="chat-log">
    <div class="msg bot">ボット: カテゴリを選んでください。</div>
    <div class="msg bot hint">ボット: 外部通信はしません。全てこのページ内で動きます。</div>
  </div>

  <!-- 回答表示 -->
  <div id="answer-wrap">
    <h4 id="answer-title">回答</h4>
    <div id="answer-box"></div>
    <div id="answer-tools">
      <button id="btnCopyAns" class="btn">コピー</button>
      <button id="btnBackList" class="btn">一覧へ</button>
    </div>
  </div>
</div>
<script src="js/chat.js"></script>
</body>
</html>

